mapboxgl.accessToken="pk.eyJ1IjoiYXp1bmE5NSIsImEiOiJjanNia2tpbzMwOW43NDRteTRuaHpyOWtlIn0.Qukc-uhQ_M-Q7TaX4XhgZw";var map=new mapboxgl.Map({container:"map",style:"mapbox://styles/mapbox/streets-v11",center:[4.835659,45.764043],zoom:15});$("#FormInscription").on("submit",function(e){e.preventDefault(),username=$("input[name=username]").val(),password=$("input[name=password]").val(),serializeFormInscription=$(this).serialize(),console.log(serializeFormInscription);$.ajax({type:"POST",url:"http://localhost/Velocity/api/inscription.php",data:serializeFormInscription,success:function(e){console.log(e)}})}),$(document).ready(function(){$("#formLogin").on("submit",function(e){e.preventDefault();const o=$(this).serialize();console.log(o),$.ajax({type:"POST",url:"http://localhost/Velocity/api/checkUser.php",data:o,success:function(e){if(console.log(e),e=JSON.parse(e),console.log(e),user=e,e.username){$("#formLogin").hide(),$("#FormInscription").hide(),$("#logotitre").hide(),$("#chr").show(),$("#map").show(),$("#burger").show(),$("#sidebar").show(),$("#sidebarD").show();var o=$("#map"),n=$(".mapboxgl-canvas");o.css("width","100%"),n.css("width","100%"),map.resize()}}})})});var user,urlAPI="http://localhost/Velocity/api";function formSubmitPopup(e,o,n){e.preventDefault(),console.log(o),console.log(user.id);var t=user.id;$.ajax({type:"POST",url:`${urlAPI}/index.php`,crossDomain:!0,data:{idStation:o,bikeStands:n,userId:t},success:function(e){(n-=1)<=0?($("#velosdispos").html("0"),$("#form-reservation").hide(),$("#message-station").html("Plus de vélos disponibles!")):($("#velosdispos").html(n),$("#message-station").html("Bravo! Votre vélo est bien réservé."),$("#form-reservation").attr("onsubmit","formSubmitPopup(event, "+o+", "+n+")"),IndiquerMinutes(timerPartie.temps.value),DemarrerChrono())}})}function openNav(){document.getElementById("myNav").style.width="100%"}function closeNav(){document.getElementById("myNav").style.width="0%"}function IndiquerMinutes(e){secondes=60*e}function DemarrerChrono(){timer=setInterval("Chrono()",1e3)}$.ajax({type:"GET",dataType:"JSON",url:"https://api.jcdecaux.com/vls/v1/stations?contract=lyon&apiKey=d14aebea0e323a982ae35f24dc55997349182b9f",success:function(e){console.log(e),e.forEach(function(e){document.createElement("div").id="marker",new mapboxgl.Marker(e).setLngLat(e.position).setPopup(new mapboxgl.Popup({offset:25}).setHTML(`\n                <h5>${e.address}</h5>\n                <p id="message-station"></p>  \n                <strong> Vélos disponibles : <span id="velosdispos">${e.available_bikes}</span> /${e.bike_stands}</strong>\n                <p>${e.number}</p>\n                <form id="form-reservation" onSubmit="formSubmitPopup(event, ${e.number}, ${e.available_bikes})">\n                    <input type="submit" value="RESERVER">\n                </form>\n            `)).addTo(map)})},error:function(e){console.log("error")}});var timer,secondes=0,pause=!1,text="";function Chrono(){if(secondes>0){var e=Math.floor(secondes/60),o=Math.floor(e/60);secondes-=60*e,o>0?(e-=60*o,secondes=secondes+60*(e+=60*o)-1):e<10&&secondes>9?(text="0"+e+" : "+secondes,secondes=secondes+60*e-1):e>9&&secondes<10?(text=e+" : 0"+secondes,secondes=secondes+60*e-1):e<10&&secondes<10?(text="0"+e+" : 0"+secondes,secondes=secondes+60*e-1):(text=e+" : "+secondes,secondes=secondes+60*e-1),$("#chrono").html(text)}else clearInterval(timer),text="00 : 00"}var modal=document.getElementById("myModal"),btn=document.getElementById("myBtn"),span=document.getElementsByClassName("close")[0];btn.onclick=function(){modal.style.display="block"},span.onclick=function(){modal.style.display="none"},window.onclick=function(e){e.target==modal&&(modal.style.display="none")};var modale=document.getElementById("myModale");btn=document.getElementById("myBtn2"),span=document.getElementsByClassName("closee")[0];btn.onclick=function(){modale.style.display="block"},span.onclick=function(){modale.style.display="none"},window.onclick=function(e){e.target==modale&&(modale.style.display="none")};var modalee=document.getElementById("myModalee");btn=document.getElementById("myBtn3"),span=document.getElementsByClassName("closeee")[0];btn.onclick=function(){modalee.style.display="block"},span.onclick=function(){modalee.style.display="none"},window.onclick=function(e){e.target==modalee&&(modalee.style.display="none")};var modaleee=document.getElementById("myModaleee");btn=document.getElementById("myBtn5"),span=document.getElementsByClassName("closeeee")[0];btn.onclick=function(){modaleee.style.display="block"},span.onclick=function(){modaleee.style.display="none"},window.onclick=function(e){e.target==modaleee&&(modaleee.style.display="none")};var modal1=document.getElementById("myModal1");btn=document.getElementById("myBtn8"),span=document.getElementsByClassName("close1")[0];btn.onclick=function(){modal1.style.display="block"},span.onclick=function(){modal1.style.display="none"},window.onclick=function(e){e.target==modal1&&(modal1.style.display="none")};